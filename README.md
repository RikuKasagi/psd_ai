# PSD AI - é«˜é€Ÿãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 

PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ©Ÿæ¢°å­¦ç¿’ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹é«˜é€Ÿå‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

## ğŸš€ ä¸»è¦æ©Ÿèƒ½

- **ğŸ”¥ åŠ‡çš„é«˜é€ŸåŒ–**: è‰²ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ã‚’20-200å€é«˜é€ŸåŒ–ï¼ˆNumPyãƒ™ã‚¯ãƒˆãƒ«åŒ–å‡¦ç†ï¼‰
- **âš¡ ãƒãƒƒãƒå‡¦ç†**: è¤‡æ•°PSDãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†
- **ğŸ¯ æ–°ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ä»•æ§˜**: `stride = tile_size - (overlap Ã— 2)` ã«ã‚ˆã‚‹æ­£ç¢ºãªé‡è¤‡åˆ¶å¾¡
- **ğŸ”„ è‡ªå‹•ç”»åƒå¤‰æ›**: æ¨ªé•·ç”»åƒã‚’ç¸¦å‘ãã«è‡ªå‹•å¤‰æ›
- **ğŸ“Š è©³ç´°ãƒ­ã‚°**: å„å‡¦ç†æ®µéšã®æ™‚é–“è¨ˆæ¸¬ã¨ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š
- **ğŸ§¹ çµ±ä¸€å‘½å**: train/val/testå†…ã§00001.pngå½¢å¼ã®é€šã—ç•ªå·

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
psd_ai/
â”œâ”€â”€ README.md
â”œâ”€â”€ LICENSE                     # MIT License
â”œâ”€â”€ requirements.txt            # ä¾å­˜é–¢ä¿‚
â”œâ”€â”€ setup.py                   # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¨­å®š
â”œâ”€â”€ generate_dataset.py         # å˜ä¸€PSDãƒ•ã‚¡ã‚¤ãƒ«ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆ
â”œâ”€â”€ generate_batch_dataset.py   # ğŸ†• è¤‡æ•°PSDãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬å‡¦ç†
â”œâ”€â”€ __init__.py                # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ config/                    # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ classes.yaml           # ã‚¯ãƒ©ã‚¹å®šç¾©è¨­å®š
â”‚   â””â”€â”€ build_config.yaml      # ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®š
â”œâ”€â”€ tools/                     # ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆãƒ„ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ mask_builder.py        # ãƒã‚¹ã‚¯çµ±åˆ
â”‚   â”œâ”€â”€ tiler.py              # ã‚¿ã‚¤ãƒ«åˆ†å‰²ï¼ˆæ–°ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ä»•æ§˜ï¼‰
â”‚   â”œâ”€â”€ splitter.py           # ãƒ‡ãƒ¼ã‚¿åˆ†å‰²
â”‚   â”œâ”€â”€ pipeline.py           # å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
â”‚   â””â”€â”€ batch_pipeline.py     # ğŸ†• ãƒãƒƒãƒå‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ dataset/              # ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ color_map.py      # è‰²â†’ã‚¯ãƒ©ã‚¹IDãƒãƒƒãƒ”ãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ io_utils.py       # å…¥å‡ºåŠ›ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ log.py            # ãƒ­ã‚°ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ manifest.py       # ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ validate.py       # æ¤œè¨¼
â”‚   â””â”€â”€ psd_tools/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ psd_split.py       # PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŠ½å‡º
â”‚       â””â”€â”€ psd_maker.py       # PNGç”»åƒã‹ã‚‰PSDãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
â”œâ”€â”€ dataset/                  # ç”Ÿæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆå‡ºåŠ›å…ˆï¼‰
â”œâ”€â”€ manifests/                # å®Ÿè¡Œãƒ¡ã‚¿æƒ…å ±
â””â”€â”€ logs/                     # å®Ÿè¡Œãƒ­ã‚°
```

## ğŸš€ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### æ–¹æ³•1: pip installï¼ˆæ¨å¥¨ï¼‰

```bash
pip install git+https://github.com/RikuKasagi/psd_ai.git
```

### æ–¹æ³•2: æ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
git clone https://github.com/RikuKasagi/psd_ai.git
cd psd_ai
pip install -r requirements.txt
pip install -e .
```

### æ–¹æ³•3: ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã¿ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install psd-tools pytoshop pillow numpy
```

## ğŸ“– æ©Ÿèƒ½èª¬æ˜

### ğŸ†• ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 

PSDãƒ¬ã‚¤ãƒ¤ãƒ¼ã‹ã‚‰æ©Ÿæ¢°å­¦ç¿’ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹åŒ…æ‹¬çš„ãªã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

**ğŸ”¥ ä¸»è¦æ©Ÿèƒ½:**

- **ãƒãƒƒãƒå‡¦ç†å¯¾å¿œ**: è¤‡æ•°PSDãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†ãŒå¯èƒ½
- **åŠ‡çš„é«˜é€ŸåŒ–**: è‰²ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ã‚’20-200å€é«˜é€ŸåŒ–ï¼ˆNumPyãƒ™ã‚¯ãƒˆãƒ«åŒ–å‡¦ç†ï¼‰
- **æ–°ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ä»•æ§˜**: `stride = tile_size - (overlap Ã— 2)` ã§æ­£ç¢ºãªé‡è¤‡åˆ¶å¾¡
- **æ¨ªé•·ç”»åƒè‡ªå‹•å¤‰æ›**: æ¨ªé•·ç”»åƒã‚’ç¸¦å‘ãã«è‡ªå‹•å¤‰æ›ã—ã¦ã‹ã‚‰ã‚¿ã‚¤ãƒ«åˆ†å‰²
- **ã‚°ãƒªãƒƒãƒ‰åˆ†å‰²**: æŒ‡å®šã‚°ãƒªãƒƒãƒ‰æ•°ã§ç”»åƒã‚’ãƒªã‚µã‚¤ã‚ºã—ã¦å‡ç­‰åˆ†å‰²
- **ãƒã‚¹ã‚¯çµ±åˆ**: maskå„ªå…ˆã§refinedã‚’ãƒãƒ¼ã‚¸ã—ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒã‚¹ã‚¯ã‚’ç”Ÿæˆ
- **é€šã—ç•ªå·å‘½å**: train/val/testå†…ã§00001.pngå½¢å¼ã®é€šã—ç•ªå·
- **ãƒ©ãƒ³ãƒ€ãƒ åˆ†å‰²**: å…¨PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¿ã‚¤ãƒ«ã‚’åé›†å¾Œã€ãƒ©ãƒ³ãƒ€ãƒ ã«train/val/testã«åˆ†å‰²
- **ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†**: å‡¦ç†ä¸­ã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ï¼ˆå‰Šé™¤å¯/ä¸å¯é¸æŠï¼‰
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ**: manifestã¨ãƒ­ã‚°ã‚’è‡ªå‹•ç”Ÿæˆ
- **æ¤œè¨¼æ©Ÿèƒ½**: å…¥åŠ›ãƒ»å‡ºåŠ›ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
- **è©³ç´°ãƒ­ã‚°**: å„å‡¦ç†æ®µéšã®æ™‚é–“è¨ˆæ¸¬ã¨ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š

### PSDãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ©Ÿèƒ½

åŸºæœ¬çš„ãªPSDå‡¦ç†æ©Ÿèƒ½ã‚‚æä¾›ã—ã¦ã„ã¾ã™ï¼š

- **ãƒ¬ã‚¤ãƒ¤ãƒ¼æŠ½å‡º**: PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’PNGç”»åƒã¨ã—ã¦æŠ½å‡º
- **PSDä½œæˆ**: è¤‡æ•°PNGç”»åƒã‹ã‚‰PSDãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

**ğŸ”„ å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰:**

1. è¤‡æ•°PSDãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ»èª­ã¿è¾¼ã¿
2. å„PSDã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼æŠ½å‡ºï¼ˆoriginal, mask, refinedï¼‰
3. ãƒã‚¹ã‚¯çµ±åˆï¼ˆå„ªå…ˆåº¦: mask > refinedï¼‰
4. æ¨ªé•·â†’ç¸¦å‘ãå¤‰æ›ï¼ˆauto_orient: trueï¼‰
5. ã‚°ãƒªãƒƒãƒ‰åˆ†å‰²ç”¨ãƒªã‚µã‚¤ã‚º
6. ã‚¿ã‚¤ãƒ«åˆ†å‰²ï¼ˆæ–°ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ä»•æ§˜ï¼‰
7. å…¨ã‚¿ã‚¤ãƒ«åé›†ãƒ»ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ£ãƒƒãƒ•ãƒ«
8. train/val/testãƒ©ãƒ³ãƒ€ãƒ åˆ†å‰²ï¼ˆé€šã—ç•ªå·å‘½åï¼‰
9. ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ»ãƒ­ã‚°ç”Ÿæˆ

**ğŸ’¡ ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ä»•æ§˜:**
```
tile_size = 512, overlap = 128ã®å ´åˆ
â”œâ”€ å‡ºåŠ›ã‚¿ã‚¤ãƒ«: 512Ã—512ãƒ”ã‚¯ã‚»ãƒ«ï¼ˆãƒ•ãƒ«ã‚µã‚¤ã‚ºï¼‰
â”œâ”€ æ–°è¦éƒ¨åˆ†: 256Ã—256ãƒ”ã‚¯ã‚»ãƒ«ï¼ˆé‡è¤‡ãªã—éƒ¨åˆ†ï¼‰
â”œâ”€ stride: 256ãƒ”ã‚¯ã‚»ãƒ«ï¼ˆç§»å‹•è·é›¢ï¼‰
â””â”€ é‡è¤‡: ä¸Šä¸‹å·¦å³ã«128ãƒ”ã‚¯ã‚»ãƒ«ãšã¤
```

---

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### ğŸ†• ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆï¼ˆãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½ï¼‰

#### âœ… åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•

```bash
# åŸºæœ¬å®Ÿè¡Œï¼ˆãƒ•ã‚©ãƒ«ãƒ€å†…ã®å…¨PSDãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ï¼‰
python generate_batch_dataset.py psd_folder --output batch_dataset

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
python generate_batch_dataset.py psd_folder --output my_dataset --config my_config.yaml --classes my_classes.yaml

# éè¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚‚å«ã‚ã‚‹
python generate_batch_dataset.py psd_folder --output my_dataset --include-hidden

# è©³ç´°ãƒ­ã‚°å‡ºåŠ›ï¼ˆå‡¦ç†æ™‚é–“åˆ†æï¼‰
python generate_batch_dataset.py psd_folder --output my_dataset --log-level DEBUG

# ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ã‚’æ®‹ã™ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
python generate_batch_dataset.py psd_folder --output my_dataset --keep-temp
```

#### âœ… å‡ºåŠ›ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ 

```
my_dataset/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ 00001.png
â”‚   â”‚   â”œâ”€â”€ 00002.png
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ masks/
â”‚       â”œâ”€â”€ 00001.png
â”‚       â”œâ”€â”€ 00002.png
â”‚       â””â”€â”€ ...
â”œâ”€â”€ val/
â”‚   â”œâ”€â”€ images/
â”‚   â””â”€â”€ masks/
â””â”€â”€ test/
    â”œâ”€â”€ images/
    â””â”€â”€ masks/
```

### ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆè‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

#### âœ… åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•

```bash
# åŸºæœ¬å®Ÿè¡Œï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼‰
python generate_dataset.py input.psd

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š
python generate_dataset.py input.psd --config my_config.yaml --classes my_classes.yaml

# å‡ºåŠ›å…ˆã‚’æŒ‡å®š
python generate_dataset.py input.psd --output ./my_dataset

# éè¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚‚å«ã‚ã‚‹
python generate_dataset.py input.psd --include-hidden

# è©³ç´°ãƒ­ã‚°å‡ºåŠ›
python generate_dataset.py input.psd --log-level DEBUG
```

#### âœ… è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

**ã‚¯ãƒ©ã‚¹å®šç¾©ï¼ˆ`config/classes.yaml`ï¼‰:**
```yaml
# èƒŒæ™¯ã‚¯ãƒ©ã‚¹
background:
  id: 0
  name: "background"
  color: [0, 0, 0]
  alpha_threshold: 128

# å‰æ™¯ã‚¯ãƒ©ã‚¹å®šç¾©
classes:
  - id: 1
    name: "object1"
    color: [255, 0, 0]  # èµ¤
  - id: 2
    name: "object2" 
    color: [0, 255, 0]  # ç·‘
```

**ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®šï¼ˆ`config/build_config.yaml`ï¼‰:**

```yaml
# ã‚¿ã‚¤ãƒ«åˆ†å‰²è¨­å®šï¼ˆæ–°ä»•æ§˜ï¼‰
tiling:
  tile_size: 512          # æ­£æ–¹å½¢ã‚¿ã‚¤ãƒ«ã‚µã‚¤ã‚º
  grid_size: [18, 5]       # [ç¸¦ã®åˆ†å‰²æ•°, æ¨ªã®åˆ†å‰²æ•°]
  overlap: 128            # ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ãƒ”ã‚¯ã‚»ãƒ«æ•°ï¼ˆç‰‡å´ï¼‰
  auto_orient: true       # æ¨ªé•·ç”»åƒã‚’ç¸¦å‘ãã«å¤‰æ›
  padding:
    mode: "constant"      # constant, reflect, symmetric
    value: 0             # ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å€¤
  min_foreground_ratio: 0.0  # å‰æ™¯ãƒ”ã‚¯ã‚»ãƒ«æœ€å°æ¯”ç‡

# ãƒ‡ãƒ¼ã‚¿åˆ†å‰²è¨­å®š
data_split:
  train_ratio: 0.8
  val_ratio: 0.1
  test_ratio: 0.1
  seed: 42              # ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ£ãƒƒãƒ•ãƒ«ç”¨ã‚·ãƒ¼ãƒ‰å€¤

# å‡ºåŠ›è¨­å®š
output:
  base_path: "./dataset"
  image_format: "PNG"
  mask_format: "PNG"
  compression: 6          # PNGåœ§ç¸®ãƒ¬ãƒ™ãƒ«ï¼ˆ0-9ï¼‰
```

#### âœ… ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰ã®å®Ÿè¡Œ

```python
from tools.pipeline import DatasetPipeline
from utils.psd_tools.psd_split import extract_layers_from_psd

# 1. PSDã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼æŠ½å‡º
layers = extract_layers_from_psd("input.psd", include_hidden=True)

# 2. ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åˆæœŸåŒ–
pipeline = DatasetPipeline(
    config_path="./config/build_config.yaml",
    classes_config_path="./config/classes.yaml"
)

# 3. ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆ
result = pipeline.generate_dataset(
    layers=layers,
    output_path="./dataset"
)

print(f"ç”Ÿæˆå®Œäº†: {result['tiles_generated']}ã‚¿ã‚¤ãƒ«")
```

---

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```python
# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆã®åŸºæœ¬çš„ãªä½¿ç”¨
from tools.batch_pipeline import BatchPipeline

# ãƒãƒƒãƒãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åˆæœŸåŒ–
pipeline = BatchPipeline(
    config_path="./config/build_config.yaml",
    classes_config_path="./config/classes.yaml"
)

# ãƒãƒƒãƒå‡¦ç†å®Ÿè¡Œ
result = pipeline.process_batch(
    psd_folder="./psd_folder",
    output_path="./dataset",
    include_hidden=False,
    keep_temp=False
)

print(f"ç”Ÿæˆå®Œäº†: {result['total_tiles_generated']}ã‚¿ã‚¤ãƒ«")
```

### PSDãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆåŸºæœ¬æ©Ÿèƒ½ï¼‰

```python
from psd_ai import extract_layers_from_psd, save_images_as_psd

# PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŠ½å‡º
layers = extract_layers_from_psd("input.psd")

# PNGç”»åƒã‹ã‚‰PSDãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
save_images_as_psd(
    image_paths=["bg.png", "fg.png"],
    layer_names=["èƒŒæ™¯", "å‰æ™¯"],
    save_path="output.psd"
)
```

---

## ğŸ¯ **API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**

### `extract_layers_from_psd(psd_path, include_hidden=False)`

PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŠ½å‡ºã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `psd_path` (str): PSDãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
- `include_hidden` (bool): éè¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚‚å«ã‚ã‚‹ã‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Falseï¼‰

**æˆ»ã‚Šå€¤:**
- `Dict[str, Image.Image]`: ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‚’ã‚­ãƒ¼ã¨ã—ãŸè¾æ›¸

### `save_images_as_psd(image_paths, layer_names, save_path)`

PNGç”»åƒã‹ã‚‰PSDãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
- `image_paths` (List[str]): PNGç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãƒªã‚¹ãƒˆ
- `layer_names` (List[str]): ãƒ¬ã‚¤ãƒ¤ãƒ¼åã®ãƒªã‚¹ãƒˆ
- `save_path` (str): ä¿å­˜å…ˆPSDãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹

---

## âš ï¸ æ³¨æ„äº‹é …

### PSDåˆ†å‰² (`psd_split.py`)

- âœ… **å¯¾å¿œå½¢å¼**: PSDãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿
- âœ… **å‡ºåŠ›å½¢å¼**: PNGï¼ˆRGBAãƒ¢ãƒ¼ãƒ‰ï¼‰
- âœ… **å‡ºåŠ›ã‚µã‚¤ã‚º**: å…ƒã®PSDã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºã§çµ±ä¸€
- âœ… **éè¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼**: `include_hidden=True` ã§æŠ½å‡ºå¯èƒ½

### PSDä½œæˆ (`psd_maker.py`)

- âœ… **å…¥åŠ›å½¢å¼**: PNGãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿
- âš ï¸ **ã‚µã‚¤ã‚ºåˆ¶é™**: å…¨ã¦ã®ç”»åƒãŒåŒã˜ã‚µã‚¤ã‚ºã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- âš ï¸ **ãƒ¬ã‚¤ãƒ¤ãƒ¼é †**: `image_paths[0]`ãŒæœ€ä¸‹å±¤ã«ãªã‚Šã¾ã™

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ–¹æ³•

#### 1. `ModuleNotFoundError`
```
è§£æ±ºæ–¹æ³•: pip install psd-tools pytoshop pillow numpy
```

#### 2. `FileNotFoundError`
```
åŸå› : æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„
è§£æ±ºæ–¹æ³•: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„
```

#### 3. `ValueError: ç”»åƒã‚µã‚¤ã‚ºãŒä¸€è‡´ã—ã¦ã„ã¾ã›ã‚“`
```
åŸå› : PNGç”»åƒã®ã‚µã‚¤ã‚ºãŒãƒãƒ©ãƒãƒ©
è§£æ±ºæ–¹æ³•: å…¨ã¦ã®ç”»åƒã‚’åŒã˜ã‚µã‚¤ã‚ºã«ãƒªã‚µã‚¤ã‚ºã—ã¦ãã ã•ã„
```

#### 4. `ValueError: PNGä»¥å¤–ãŒå«ã¾ã‚Œã¦ã„ã¾ã™`
```
åŸå› : PNGä»¥å¤–ã®å½¢å¼ã®ç”»åƒãŒå«ã¾ã‚Œã¦ã„ã‚‹
è§£æ±ºæ–¹æ³•: å…¨ã¦ã®ç”»åƒã‚’PNGå½¢å¼ã«å¤‰æ›ã—ã¦ãã ã•ã„
```

---

## ğŸ’¡ ä½¿ç”¨ä¾‹

### å®Œå…¨ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¾‹

```python
import os
from psd_ai import extract_layers_from_psd, save_images_as_psd

# 1. PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŠ½å‡ºï¼ˆéè¡¨ç¤ºãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚‚å«ã‚€ï¼‰
print("ğŸ“‚ PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æŠ½å‡ºä¸­...")
layers = extract_layers_from_psd("original.psd", include_hidden=True)

# 2. æŠ½å‡ºã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’PNGã¨ã—ã¦ä¿å­˜
print("ğŸ’¾ ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’PNGã¨ã—ã¦ä¿å­˜ä¸­...")
temp_dir = "temp_layers"
os.makedirs(temp_dir, exist_ok=True)

png_paths = []
layer_names = []

for layer_name, image in layers.items():
    safe_name = "".join(c if c.isalnum() or c in (' ', '-', '_') else '_' for c in layer_name)
    png_path = os.path.join(temp_dir, f"{safe_name}.png")
    image.save(png_path)
    png_paths.append(png_path)
    layer_names.append(layer_name)

# 3. PNGãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ–°ã—ã„PSDã‚’ä½œæˆ
print("ğŸ”„ æ–°ã—ã„PSDãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆä¸­...")
save_images_as_psd(
    image_paths=png_paths,
    layer_names=layer_names,
    save_path="recreated.psd"
)

print("âœ… å‡¦ç†å®Œäº†!")
```

---

## ğŸ“ é–‹ç™ºæƒ…å ±

- **èª­ã¿è¾¼ã¿**: `psd-tools`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ï¼ˆå®‰å®šæ€§é‡è¦–ï¼‰
- **ä½œæˆ**: `pytoshop`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ï¼ˆæ©Ÿèƒ½å……å®Ÿï¼‰
- **ç”»åƒå‡¦ç†**: `PIL (Pillow)`ã‚’ä½¿ç”¨
- **æ•°å€¤å‡¦ç†**: `NumPy`ã‚’ä½¿ç”¨
- **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**: MIT License
- **Python**: 3.8+ å¯¾å¿œ

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. Pull Request ã‚’ä½œæˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT License ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚è©³ç´°ã¯ [LICENSE](LICENSE) ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚

---

**ğŸš€ æ–°æ©Ÿèƒ½**:

- **ãƒãƒƒãƒå‡¦ç†ã‚·ã‚¹ãƒ†ãƒ **: è¤‡æ•°PSDãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ‹¬å‡¦ç†ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸï¼
- **æ–°ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ä»•æ§˜**: ã‚ˆã‚Šæ­£ç¢ºãªé‡è¤‡åˆ¶å¾¡
- **æ¨ªé•·ç”»åƒè‡ªå‹•å¤‰æ›**: æ¨ªé•·ç”»åƒã‚’ç¸¦å‘ãã«è‡ªå‹•å¤‰æ›
- **é€šã—ç•ªå·å‘½å**: train/val/testå†…ã§00001.pngå½¢å¼ã®çµ±ä¸€å‘½å
- **ãƒ©ãƒ³ãƒ€ãƒ åˆ†å‰²**: å…¨PSDãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¿ã‚¤ãƒ«åé›†å¾Œã€å®Œå…¨ãƒ©ãƒ³ãƒ€ãƒ åˆ†å‰²
- **ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†**: ãƒ‡ãƒãƒƒã‚°ç”¨ã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ä¿æŒã‚ªãƒ—ã‚·ãƒ§ãƒ³